<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: wallet.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: wallet.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>$("#_0101_button_create").click(function () {
  let pw = $("#_0101_input_password").val();
  MakeAndSaveWallet(pw);
});

$("#_0101_button_login").click(function () {
  let pw = $("#_0101_input_password").val();
  LoadWallet(pw);
});

/**
 * Make new wallet and save it to (1) web3js's local storage (2) chrome extension storage
 * @async
 * @function MakeAndSaveWallet
 * @param {string} pw - password to be set
 */
async function MakeAndSaveWallet(pw) {
  pw = await _sha256(pw);
  web3.eth.accounts.wallet.clear();
  web3.eth.accounts.wallet.create(0, "randomstring");
  await chrome.storage.sync.clear();

  if (web3.eth.accounts.wallet.save(pw)) {
    const saveinfo = _StorageStruct(pw);
    chrome.storage.sync.set(saveinfo, function () {
      GoHome();
    });
  } else {
    alert("[ERROR] Wallet not created. Please try later.");
  }
}
/**
 * Load existing wallet
 * @async
 * @function LoadWallet
 * @param  {string} pw - password of the wallet
 */
async function LoadWallet(pw) {
  pw = await _sha256(pw);
  console.log(pw);
  chrome.storage.sync.get(null, function (res) {
    console.log(res);
    if (res["walletpw"] != undefined &amp;&amp; res["walletpw"] == pw) {
      GoHome();
    } else {
      alert("[ERROR] Invalid password.");
    }
  });
}
/**
 * sha256 for hashing password
 * @async
 * @function _sha256
 * @param  {string} message - string that should be hashed
 * @returns {string} hashed result
 */
async function _sha256(message) {
  const msgBuffer = new TextEncoder().encode(message);
  const hashBuffer = await crypto.subtle.digest("SHA-256", msgBuffer);
  const hashArray = Array.from(new Uint8Array(hashBuffer));
  const hashHex = hashArray
    .map((b) => b.toString(16).padStart(2, "0"))
    .join("");
  return hashHex;
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#_Deployer">_Deployer</a></li><li><a href="global.html#_GetBalance_EtherAndToken">_GetBalance_EtherAndToken</a></li><li><a href="global.html#_GetTokenAddress">_GetTokenAddress</a></li><li><a href="global.html#_sha256">_sha256</a></li><li><a href="global.html#AccountDetail">AccountDetail</a></li><li><a href="global.html#AccountTransition">AccountTransition</a></li><li><a href="global.html#AddOptionsForAccountTransition">AddOptionsForAccountTransition</a></li><li><a href="global.html#AddOptionsForSend">AddOptionsForSend</a></li><li><a href="global.html#AutoLoad_Check">AutoLoad_Check</a></li><li><a href="global.html#AutoLoad_Execute">AutoLoad_Execute</a></li><li><a href="global.html#ChangeName">ChangeName</a></li><li><a href="global.html#CreateAccount">CreateAccount</a></li><li><a href="global.html#GetBytecodeAndDeploy">GetBytecodeAndDeploy</a></li><li><a href="global.html#GoHome">GoHome</a></li><li><a href="global.html#LoadAccount">LoadAccount</a></li><li><a href="global.html#LoadToken">LoadToken</a></li><li><a href="global.html#LoadWallet">LoadWallet</a></li><li><a href="global.html#MakeAndSaveWallet">MakeAndSaveWallet</a></li><li><a href="global.html#SendTok">SendTok</a></li><li><a href="global.html#SendTx">SendTx</a></li><li><a href="global.html#UpdateTokenBalance">UpdateTokenBalance</a></li><li><a href="global.html#ValidateSendInfo_Ether">ValidateSendInfo_Ether</a></li><li><a href="global.html#ValidateSendInfo_Token">ValidateSendInfo_Token</a></li><li><a href="global.html#ValidateTokenCreateInfo">ValidateTokenCreateInfo</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Fri Feb 18 2022 15:18:35 GMT+0900 (Korean Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
